# 1. 작업문서

#### 

### 1) prerequisites

##### version

- JVM : openjdk 1.8.0_192

- Tomcat : apache-tomcat-9.0.43

- Spring Tool Suite : 3.9.14.RELEASE

- VS code : 1.59



### 2) environment variables

- **kakao API**

  경로 :  \frontend\ .env.local

  ```
  VUE_APP_KAKAO_ID=d9244e59520303e14f40a6a210aae21d
  VUE_APP_KAKAO_URI=https://i5c203.p.ssafy.io/user/loading
  ```

  VUE_APP_KAKAO_ID : 카카오에서 제공한 REST api key

  VUE_APP_KAKAO_URI : 인증 완료 후 redirect 될 uri

- **Discord** 

  경로 : (backend\src\main\resources\application.properties)

  ```
  jda.discord.token=ODcyMjk5MzEzODEwNzY3OTMz.YQn2Cg.laaG7eejNueUdmlrwGpB9hisyi0
  jda.discord.guild.id=865502741388722216
  jda.discord.guild.category.id=865502741388722220
  ```

  jda.discord.token : 디스코드 봇과 통신하기 위한 토큰

  jda.discord.guild.id : 디스코드 서버 고유아이디 

  jda.discord.guild.category.id : 디스코드 서버 내 카테고리 아이디



### 3) 배포 시 특이사항 기재

- **nginx 설정** 

​	경로 : /etc/nginx/sites-enabled/default

```
		location /chat {
                proxy_pass http://localhost:3001;
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection "upgrade";
                proxy_http_version 1.1;
                proxy_set_header Host $host;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header X-Forwarded-Proto $scheme;
                proxy_set_header X-Forwarded-Host $host;
                proxy_set_header X-Forwarded-Port $server_port;
        }

        location /api {
                proxy_pass http://localhost:8080;
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection "upgrade";
                proxy_http_version 1.1;
                proxy_set_header Host $host;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header X-Forwarded-Proto $scheme;
                proxy_set_header X-Forwarded-Host $host;
                proxy_set_header X-Forwarded-Port $server_port;
        }
```

Socket IO와 Backend 서버와의 통신을 위한 Nginx 설정 필수



- **채팅서버 설정**

  경로 : /backend/chat/server.js

```
const fs = require('fs')
const options = {
    cert: fs.readFileSync('/etc/letsencrypt/live/i5c203.p.ssafy.io/fullchain.pem'),
    key: fs.readFileSync('/etc/letsencrypt/live/i5c203.p.ssafy.io/privkey.pem')
};

var app = require("express")();
var server = require("https").createServer(options, app);
var io = require("socket.io")(server, {
    cors: {
        origin: "*",
        methods: ["GET", "POST"]
      }
});
```

certificate file, private key 경로 지정

모든 경로에 cors 허용



### 4) db 접속정보

```
spring.datasource.driverClassName=com.mysql.cj.jdbc.Driver
spring.datasource.url=jdbc:mysql://i5c203.p.ssafy.io:3306/hamgo?useUniCode=yes&characterEncoding=UTF-8&serverTimezone=Asia/Seoul
spring.datasource.username=root
spring.datasource.password=hamgo!234
```

username : root

password : hamgo!234

DB 명 : hamgo



# 2. 외부 서비스 정보

1) 카카오 API

​	kakao developers > '내 어플리케이션' > 카카오 로그인 > Redirect URI 설정

![image-20210817214437439](C:\Users\multicampus\AppData\Roaming\Typora\typora-user-images\image-20210817214437439.png)

kakao developers 에 hamgo 등록(도메인 등록)

'내 어플리케이션' > 카카오 로그인 에 인증을 완료한 다음 넘어갈 URI 를 Redirect URI 에 설정



2) JDA (Java Discord API)

​	디스코드 서버 생성, 채널 생성, 멤버 권한 부여 등의 작업을 수행할 수 있는 API





# 3. 데이터베이스 덤프 파일 최신본

데이터베이스 : hamgo 

 [광주2반_3팀_SQL.sql](..\..\Downloads\광주2반_3팀_SQL.sql) 
